<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Math Battle</title>
  <link rel="icon" type="image/x-icon" href="/img/logo.ico" />
  <link rel="stylesheet" href="/css/play.css">
  <script src="/js/jquery-3.1.1.js" charset="utf-8"></script>
  <script src="/js/jquery.cookie.js"></script>
  <script type="text/javascript">
    if ($.cookie("name") === undefined) {
      window.location.href = '/';
    } else if ($.cookie("level") === undefined) {
      window.location.href = '/level';
    }
  </script>
</head>

<body>
  <div class="header">
    <span id="name"></span>
    <span id="level" class="right"></span>
  </div>
  <table class="bar">
    <tr>
      <td>
        <div class="hp-bar left-oblique">
          <div id="ally" class="hp"></div>
        </div>
      </td>
      <td rowspan="2" class="time">
        <center id="count"></center>
      </td>
      <td>
        <div class="right hp-bar right-oblique">
          <div id="opponent" class="hp"></div>
        </div>
      </td>
    </tr>
    <tr>
      <td>
        <span class="details">Ally - ATK : 10 , HP : 100</span>
      </td>
      <td>
        <span class="details right"><span class="right">Opponent - ATK : 10 , HP : 100</span></span>
      </td>
    </tr>
  </table>
  <center id="QA">
    <button class="start">Start</button>
    <div class="content">
      <div class="question">
        <span id="q">17+51-85</span>
      </div>
      <label class="answer">Answer : <input type="number" id="ans"></label>
      <input type="button" id="submit" value="Submit">
    </div>
  </center>
  <center>
    <img src="/img/me.png" alt="mario" width="100px">
  </center>
  <script type="text/javascript">
    $('#name').text('Name : ' + decodeURI($.cookie("name")));
    $('#level').text('Level : ' + $.cookie("level"));
    $('.content').hide();
    $('#count').hide();

    $('.start').click(function() {
      $(this).hide();
      $('.content').show();
      $('#count').show();
      $('#count').text('Start!');
      var count = 5;
      var countdown = setInterval(function() {
        $('#count').text(count);
        if (count == 0) {
          $('#count').html('<font color="red">Time out!</font>');
        }
        count--;
        if (count < 0) {
          clearInterval(countdown);
        }
      }, 1000);

      $('#submit').click(function() {
        $('#ans').val('').focus();
        $('#count').html('<font color="#0dc90d">Correct!</font>');
        clearInterval(countdown);
      });

      /****************************************
       *    โค้ดส่วนนี้ นำมาจาก
       *    http://stackoverflow.com/questions/9146651/trigger-an-event-on-click-and-enter
       */
      $('#ans').keypress(function(e) {
        if (e.which == 13) {
          $('#submit').click();
        }
      });
      /***************************************/
    });
  </script>
</body>

</html>
